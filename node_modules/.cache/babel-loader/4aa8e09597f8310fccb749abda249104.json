{"ast":null,"code":"import _objectSpread from \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/src/pages/AuthorizationPage.js\";\nimport React from 'react';\nimport AuthorizationForm from '../components/AuthorizationForm/AuthorizationForm';\nimport styles from './AuthorizationPage.module.css';\nimport Spinner from 'react-bootstrap/Spinner';\n\nfunction formatBirthDate(date) {\n  const _date$split = date.split('/'),\n        _date$split2 = _slicedToArray(_date$split, 3),\n        day = _date$split2[0],\n        month = _date$split2[1],\n        year = _date$split2[2];\n\n  return \"\".concat(year, \"-\").concat(month, \"-\").concat(day);\n}\n\nconst PROXY_URL = \"https://proxy-q-doctor.herokuapp.com/api/emias/\";\nconst SCHEDULE_URL = \"schedule\";\nexport default class AuthorizationPage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleAuthorization = person => {\n      localStorage.setItem('birthDate', formatBirthDate(person.birthDate));\n      localStorage.setItem('omsNumber', person.omsNumber);\n      this.setState(_objectSpread({}, this.state, {\n        loading: {\n          flg: true\n        }\n      }));\n      this.fetchSchedule(localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n    };\n\n    this.state = {\n      loading: {\n        flg: false\n      }\n    };\n    this.handleAuthorization = this.handleAuthorization.bind(this);\n  }\n\n  fetchSchedule(omsNumber, birthDate) {\n    console.log(omsNumber, birthDate);\n    return fetch(PROXY_URL + SCHEDULE_URL + \"?oms_number=\".concat(omsNumber, \"&birth_date=\").concat(birthDate), {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(response => response.json()).then(response => localStorage.setItem('schedule', JSON.stringify(response))).finally(_ => this.setState(_objectSpread({}, this.state, {\n      loading: {\n        flg: false\n      }\n    }))); // .catch(err => localStorage.setItem('schedule', JSON.stringify({})));\n  }\n\n  render() {\n    const page = React.createElement(\"div\", {\n      className: styles.page,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }, React.createElement(AuthorizationForm, {\n      handleSubmit: this.handleAuthorization,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }));\n    const loadPage = React.createElement(\"div\", {\n      className: styles.loadPage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, React.createElement(Spinner, {\n      animation: \"border\",\n      variant: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }));\n    console.log(styles.loadPage); // const goodPage = ();\n\n    return this.state.loading.flg ? loadPage : page;\n  }\n\n}\n;","map":{"version":3,"sources":["/Users/17476018U/Google Диск/Projects/Frontend/Project/DoctorsFront/src/pages/AuthorizationPage.js"],"names":["React","AuthorizationForm","styles","Spinner","formatBirthDate","date","split","day","month","year","PROXY_URL","SCHEDULE_URL","AuthorizationPage","Component","constructor","props","handleAuthorization","person","localStorage","setItem","birthDate","omsNumber","setState","state","loading","flg","fetchSchedule","getItem","bind","console","log","fetch","headers","then","response","json","JSON","stringify","finally","_","render","page","loadPage"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAOC,iBAAP,MAA8B,mDAA9B;AAEA,OAAOC,MAAP,MAAmB,gCAAnB;AAEA,OAAOC,OAAP,MAAoB,yBAApB;;AAGA,SAASC,eAAT,CAAyBC,IAAzB,EAA+B;AAAA,sBACHA,IAAI,CAACC,KAAL,CAAW,GAAX,CADG;AAAA;AAAA,QACvBC,GADuB;AAAA,QAClBC,KADkB;AAAA,QACXC,IADW;;AAE9B,mBAAUA,IAAV,cAAkBD,KAAlB,cAA2BD,GAA3B;AACA;;AAGD,MAAMG,SAAS,GAAG,iDAAlB;AACA,MAAMC,YAAY,GAAG,UAArB;AAIA,eAAe,MAAMC,iBAAN,SAAgCZ,KAAK,CAACa,SAAtC,CAAgD;AAC9DC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AAChB,UAAMA,KAAN;;AADgB,SAiBlBC,mBAjBkB,GAiBIC,MAAM,IAAI;AAC9BC,MAAAA,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCf,eAAe,CAACa,MAAM,CAACG,SAAR,CAAjD;AACFF,MAAAA,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCF,MAAM,CAACI,SAAzC;AACA,WAAKC,QAAL,mBAAkB,KAAKC,KAAvB;AAA8BC,QAAAA,OAAO,EAAE;AAACC,UAAAA,GAAG,EAAE;AAAN;AAAvC;AACE,WAAKC,aAAL,CAAmBR,YAAY,CAACS,OAAb,CAAqB,WAArB,CAAnB,EAAsDT,YAAY,CAACS,OAAb,CAAqB,WAArB,CAAtD;AACD,KAtBiB;;AAElB,SAAKJ,KAAL,GAAa;AAACC,MAAAA,OAAO,EAAE;AAACC,QAAAA,GAAG,EAAE;AAAN;AAAV,KAAb;AAEA,SAAKT,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBY,IAAzB,CAA8B,IAA9B,CAA3B;AACA;;AAEDF,EAAAA,aAAa,CAACL,SAAD,EAAYD,SAAZ,EAAuB;AACjCS,IAAAA,OAAO,CAACC,GAAR,CAAYT,SAAZ,EAAuBD,SAAvB;AACA,WAAOW,KAAK,CAACrB,SAAS,GAACC,YAAV,yBAAsCU,SAAtC,yBAA8DD,SAA9D,CAAD,EACC;AAACY,MAAAA,OAAO,EAAE;AAAC,wBAAgB;AAAjB;AAAV,KADD,CAAL,CAEJC,IAFI,CAECC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EAFb,EAGEF,IAHF,CAGOC,QAAQ,IAAIhB,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCiB,IAAI,CAACC,SAAL,CAAeH,QAAf,CAAjC,CAHnB,EAIEI,OAJF,CAIUC,CAAC,IAAI,KAAKjB,QAAL,mBAAkB,KAAKC,KAAvB;AAA8BC,MAAAA,OAAO,EAAE;AAACC,QAAAA,GAAG,EAAE;AAAN;AAAvC,OAJf,CAAP,CAFiC,CAOzB;AACT;;AASFe,EAAAA,MAAM,GAAG;AACR,UAAMC,IAAI,GACT;AAAK,MAAA,SAAS,EAAEvC,MAAM,CAACuC,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA8B,oBAAC,iBAAD;AAAmB,MAAA,YAAY,EAAE,KAAKzB,mBAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAA9B,CADD;AAIA,UAAM0B,QAAQ,GACb;AAAK,MAAA,SAAS,EAAExC,MAAM,CAACwC,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAkC,oBAAC,OAAD;AAAS,MAAA,SAAS,EAAC,QAAnB;AAA4B,MAAA,OAAO,EAAC,SAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAlC,CADD;AAGAb,IAAAA,OAAO,CAACC,GAAR,CAAY5B,MAAM,CAACwC,QAAnB,EARQ,CASR;;AAEA,WAAO,KAAKnB,KAAL,CAAWC,OAAX,CAAmBC,GAAnB,GAAyBiB,QAAzB,GAAoCD,IAA3C;AACA;;AArC6D;AAsC9D","sourcesContent":["import React from 'react';\n\nimport AuthorizationForm from '../components/AuthorizationForm/AuthorizationForm'\n\nimport styles from './AuthorizationPage.module.css'\n\nimport Spinner from 'react-bootstrap/Spinner'\n\n\nfunction formatBirthDate(date) {\n\tconst [day, month, year] = date.split('/');\n\treturn `${year}-${month}-${day}`\n}\n\n\nconst PROXY_URL = \"https://proxy-q-doctor.herokuapp.com/api/emias/\"\nconst SCHEDULE_URL = \"schedule\"\n\n\n\nexport default class AuthorizationPage extends React.Component {\n\tconstructor(props) {\n    super(props);\n\t\tthis.state = {loading: {flg: false}};\n\t\n\t\tthis.handleAuthorization = this.handleAuthorization.bind(this);\n\t}\n\n\tfetchSchedule(omsNumber, birthDate) {\n    console.log(omsNumber, birthDate)\n    return fetch(PROXY_URL+SCHEDULE_URL+`?oms_number=${omsNumber}&birth_date=${birthDate}`,\n                 {headers: {'Content-Type': 'application/json'}})\n\t\t\t\t\t\t.then(response => response.json())\n            .then(response => localStorage.setItem('schedule', JSON.stringify(response)))\n            .finally(_ => this.setState({...this.state, loading: {flg: false}}))\n            // .catch(err => localStorage.setItem('schedule', JSON.stringify({})));\n  }\n\n  handleAuthorization = person => {\n    localStorage.setItem('birthDate', formatBirthDate(person.birthDate));\n\t\tlocalStorage.setItem('omsNumber', person.omsNumber);\n\t\tthis.setState({...this.state, loading: {flg: true}});\n    this.fetchSchedule(localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n  };\n\n\trender() {\n\t\tconst page = (\n\t\t\t<div className={styles.page} ><AuthorizationForm handleSubmit={this.handleAuthorization} /></div>\n\t\t);\n\t\n\t\tconst loadPage = (\n\t\t\t<div className={styles.loadPage} ><Spinner animation=\"border\" variant=\"primary\" /></div>\n\t\t);\n\t\tconsole.log(styles.loadPage)\n\t\t// const goodPage = ();\n\n\t\treturn this.state.loading.flg ? loadPage : page;\n\t}\n};\n"]},"metadata":{},"sourceType":"module"}