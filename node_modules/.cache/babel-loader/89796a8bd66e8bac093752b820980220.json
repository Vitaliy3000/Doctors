{"ast":null,"code":"import _defineProperty from \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/src/components/Schedule/Schedule.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport styles from './Schedule.module.css';\nimport Department from './Department/Department';\nimport Doctor from './Doctor/Doctor';\nimport ScheduleFrame from './ScheduleFrame/ScheduleFrame';\nconst BASE_URL = \"https://proxy-q-doctor.herokuapp.com/api/emias/\";\nconst DEPARTMENT_URL = \"departments\";\nconst DOCTOR_URL = \"doctors/\";\nconst SCHEDULE_URL = \"schedule\";\nconst CACHE_URL = \"check_cache\";\nexport default class Schedule extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      departments: [],\n      doctors: [],\n      schedule: [],\n      department: '',\n      doctor: ''\n    };\n    this.handleClickDepartment = this.handleClickDepartment.bind(this);\n    this.handleClickDoctor = this.handleClickDoctor.bind(this);\n  }\n\n  fetchDepartments(oms_number, birth_date) {\n    return fetch(BASE_URL + DEPARTMENT_URL + \"?oms_number=\".concat(oms_number, \"&birth_date=\").concat(birth_date)).then(response => response.json()).then(response => this.setState(_objectSpread({}, this.state, {\n      departments: response\n    })));\n  }\n\n  fetchCacheCheck(oms_number, birth_date) {\n    fetch(BASE_URL + CACHE_URL + \"?oms_number=\".concat(oms_number, \"&birth_date=\").concat(birth_date));\n  }\n\n  fetchDoctors(oms_number, birth_date, speciality_id) {\n    return fetch(BASE_URL + DOCTOR_URL + speciality_id + \"?oms_number=\".concat(oms_number, \"&birth_date=\").concat(birth_date)).then(response => response.json()).then(response => this.setState(_objectSpread({}, this.state, {\n      doctors: response\n    })));\n  }\n\n  fetchSchedule(doctor) {\n    const available_resource_id = doctor['lpuRoomsInfo']['lpuRoomView'][0]['availableResourceId'];\n    const lpu_id = doctor['lpuRoomsInfo']['lpuRoomView'][0]['lpuId'];\n    return fetch(BASE_URL + SCHEDULE_URL + \"?available_resource_id=\".concat(available_resource_id, \"&lpu_id=\").concat(lpu_id)).then(response => response.json()).then(response => this.setState(_objectSpread({}, this.state, {\n      scheduleCache: response\n    })));\n  }\n\n  componentDidMount() {\n    this.fetchDepartments(this.props.omsNumber, this.props.birthDate);\n    this.fetchCacheCheck(this.props.omsNumber, this.props.birthDate);\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    if (this.state.department !== prevState.department) {\n      this.fetchDoctors(this.props.omsNumber, this.props.birthDate, this.state.department);\n    }\n\n    if (this.state.doctor !== prevState.doctor) {\n      // console.log('Doctors: ', this.state.doctor, prevState.doctor)\n      // console.log(prevState.doctor)\n      // console.log(this.state.doctor)\n      this.doctorFromSchedule(this.fetchSchedule(this.state.lpuId), this.state.doctor);\n    }\n  }\n\n  handleClickDepartment(element) {\n    if (this.state.department !== element) {\n      this.setState(_objectSpread({}, this.state, {\n        department: element,\n        doctors: [],\n        schedule: []\n      }));\n    }\n  }\n\n  handleClickDoctor(element) {\n    if (this.state.doctor !== element) {\n      this.setState(_objectSpread({}, this.state, {\n        doctor: element,\n        schedule: []\n      }));\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: styles.schedule,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.department,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(Department, {\n      items: this.state.departments,\n      handleClick: this.handleClickDepartment,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    })), this.state.doctors.length !== 0 && React.createElement(\"div\", {\n      className: styles.doctor,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(Doctor, {\n      items: this.state.doctors,\n      handleClick: this.handleClickDoctor,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    })), this.state.schedule.length !== 0 && React.createElement(\"div\", {\n      className: styles.scheduleFrame,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, React.createElement(ScheduleFrame, {\n      items: this.state.schedule,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    })));\n  }\n\n}\n;","map":{"version":3,"sources":["/Users/17476018U/Google Диск/Projects/Frontend/Project/DoctorsFront/src/components/Schedule/Schedule.js"],"names":["React","styles","Department","Doctor","ScheduleFrame","BASE_URL","DEPARTMENT_URL","DOCTOR_URL","SCHEDULE_URL","CACHE_URL","Schedule","Component","constructor","props","state","departments","doctors","schedule","department","doctor","handleClickDepartment","bind","handleClickDoctor","fetchDepartments","oms_number","birth_date","fetch","then","response","json","setState","fetchCacheCheck","fetchDoctors","speciality_id","fetchSchedule","available_resource_id","lpu_id","scheduleCache","componentDidMount","omsNumber","birthDate","componentDidUpdate","prevProps","prevState","snapshot","doctorFromSchedule","lpuId","element","render","length","scheduleFrame"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport styles from './Schedule.module.css';\n\nimport Department from './Department/Department';\nimport Doctor from './Doctor/Doctor';\nimport ScheduleFrame from './ScheduleFrame/ScheduleFrame';\n\nconst BASE_URL = \"https://proxy-q-doctor.herokuapp.com/api/emias/\"\nconst DEPARTMENT_URL = \"departments\"\nconst DOCTOR_URL = \"doctors/\"\nconst SCHEDULE_URL = \"schedule\"\nconst CACHE_URL = \"check_cache\"\n\n\nexport default class Schedule extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {departments: [], doctors: [], schedule: [], department: '', doctor: ''}\n\n\t\tthis.handleClickDepartment = this.handleClickDepartment.bind(this);\n\t\tthis.handleClickDoctor = this.handleClickDoctor.bind(this);\n\t}\n\n\tfetchDepartments(oms_number, birth_date) {\n\t\treturn fetch(BASE_URL+DEPARTMENT_URL+`?oms_number=${oms_number}&birth_date=${birth_date}`)\n\t\t\t\t\t\t.then(response => response.json())\n\t\t\t\t\t\t.then(response => this.setState({ ...this.state, departments: response}));\n\t}\n\n\tfetchCacheCheck(oms_number, birth_date) {\n\t\tfetch(BASE_URL+CACHE_URL+`?oms_number=${oms_number}&birth_date=${birth_date}`)\n\t}\n\n\tfetchDoctors(oms_number, birth_date, speciality_id) {\n\t\treturn fetch(BASE_URL+DOCTOR_URL+speciality_id+`?oms_number=${oms_number}&birth_date=${birth_date}`)\n\t\t\t\t\t\t.then(response => response.json())\n\t\t\t\t\t\t.then(response => this.setState({...this.state, doctors: response}));\n\t}\n\n\tfetchSchedule(doctor) {\n\t\tconst available_resource_id = doctor['lpuRoomsInfo']['lpuRoomView'][0]['availableResourceId']\n\t\tconst lpu_id = doctor['lpuRoomsInfo']['lpuRoomView'][0]['lpuId']\n\n\t\treturn fetch(BASE_URL+SCHEDULE_URL+`?available_resource_id=${available_resource_id}&lpu_id=${lpu_id}`)\n\t\t\t\t\t\t.then(response => response.json())\n\t\t\t\t\t\t.then(response => this.setState({...this.state, scheduleCache: response}));\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.fetchDepartments(this.props.omsNumber, this.props.birthDate);\n\t\tthis.fetchCacheCheck(this.props.omsNumber, this.props.birthDate);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (this.state.department !== prevState.department) {\n\t\t\tthis.fetchDoctors(this.props.omsNumber, this.props.birthDate, this.state.department);\n\t\t}\n\n\t\tif (this.state.doctor !== prevState.doctor) {\n\t\t\t// console.log('Doctors: ', this.state.doctor, prevState.doctor)\n\t\t\t// console.log(prevState.doctor)\n\t\t\t// console.log(this.state.doctor)\n\t\t\tthis.doctorFromSchedule(this.fetchSchedule(this.state.lpuId), this.state.doctor);\n\t\t}\n\t}\n\n\thandleClickDepartment(element) {\n\t\tif (this.state.department !== element) {\n\t\t\tthis.setState({...this.state, department: element, doctors: [], schedule: []})}\n\t}\n\n\thandleClickDoctor(element) {\n\t\tif (this.state.doctor !== element) {\n\t\t\tthis.setState({...this.state, doctor: element, schedule: []})}\n\t}\n\n  render() {\n\t\treturn (\n\t\t\t<div className={styles.schedule}>\n\t\t\t\t<div className={styles.department}>\n\t\t\t\t\t<Department items={this.state.departments} handleClick={this.handleClickDepartment} />\n\t\t\t\t</div>\n\t\t\t\t{this.state.doctors.length !== 0 &&\n\t\t\t\t\t<div className={styles.doctor}>\n\t\t\t\t\t\t<Doctor items={this.state.doctors} handleClick={this.handleClickDoctor} />\n\t\t\t\t\t</div>}\n\t\t\t\t{this.state.schedule.length !== 0 &&\n\t\t\t\t\t<div className={styles.scheduleFrame}>\n\t\t\t\t\t\t<ScheduleFrame items={this.state.schedule} />\n\t\t\t\t\t</div>}\n\t\t\t</div>\n\t\t);\n\t};\n};"]},"metadata":{},"sourceType":"module"}