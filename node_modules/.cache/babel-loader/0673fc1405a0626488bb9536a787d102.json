{"ast":null,"code":"import _objectSpread from \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/src/pages/AppointmentPage.js\";\nimport React from 'react';\nimport Tile from '../components/Tile/Tile';\nimport styles from './AppointmentPage.module.css';\nimport Spinner from 'react-bootstrap/Spinner';\nconst BASE_URL = \"https://back-q-doctor.herokuapp.com/api\";\nconst APPOINTMENT_URL = \"/people/appointments\";\nexport default class AppointmentPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      departments: [],\n      loading: {\n        flg: true\n      }\n    };\n  }\n\n  fetchAppointment(omsNumber, birthDate) {\n    return fetch(BASE_URL + APPOINTMENT_URL + \"?oms_number=\".concat(omsNumber, \"&birth_date=\").concat(birthDate), {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(response => response.json()).then(response => this.setState(_objectSpread({}, this.state, {\n      departments: response\n    }))).catch(err => this.setState(_objectSpread({}, this.state, {\n      departments: []\n    }))).finally(_ => this.setState(_objectSpread({}, this.state, {\n      loading: {\n        flg: false\n      }\n    })));\n  }\n\n  fetchDeleteAppointment(appointmentId, omsNumber, birthDate) {\n    return fetch(BASE_URL + APPOINTMENT_URL + \"/\".concat(appointmentId, \"?oms_number=\").concat(omsNumber, \"&birth_date=\").concat(birthDate), {\n      method: 'DELETE',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(() => this.setState(_objectSpread({}, this.state, {\n      departments: this.state.departments.filter(department => department.appointment_id !== appointmentId)\n    })));\n  }\n\n  handleAppointment() {\n    this.setState(_objectSpread({}, this.state, {\n      loading: {\n        flg: true\n      }\n    }));\n    this.fetchAppointment(localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n  }\n\n  handleDeleteAppointment(appointmentId) {\n    this.fetchDeleteAppointment(appointmentId, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n  }\n\n  handleDeleteAllAppointment(doctor) {\n    this.state.departments.filter(department => department.available_resource_id === doctor).map(department => this.fetchDeleteAppointment(department.appointment_id, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate')));\n  }\n\n  componentDidMount() {\n    this.handleAppointment();\n  }\n\n  render() {\n    const loadPage = React.createElement(\"div\", {\n      className: styles.loadPage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(Spinner, {\n      animation: \"border\",\n      variant: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }));\n\n    if (this.state.loading.flg) {\n      return loadPage;\n    }\n\n    const doctors = [...new Set(this.state.departments.map(x => x.available_resource_id))];\n    const emptyPage = React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, 'У вас пока нет записей!');\n    const page = React.createElement(\"div\", {\n      className: styles.page,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: styles.list,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, doctors.map(doctor => React.createElement(Tile, {\n      key: doctor,\n      handleDelete: () => this.props.handleDeleteAllAppointment(doctor),\n      handleDeleteItem: this.props.handleDeleteAppointment,\n      appointments: this.props.departments.filter(x => x.available_resource_id === doctor),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }))));\n    return this.state.departments.length === 0 ? emptyPage : page;\n  }\n\n}\n;","map":{"version":3,"sources":["/Users/17476018U/Google Диск/Projects/Frontend/Project/DoctorsFront/src/pages/AppointmentPage.js"],"names":["React","Tile","styles","Spinner","BASE_URL","APPOINTMENT_URL","AppointmentPage","Component","constructor","props","state","departments","loading","flg","fetchAppointment","omsNumber","birthDate","fetch","headers","then","response","json","setState","catch","err","finally","_","fetchDeleteAppointment","appointmentId","method","filter","department","appointment_id","handleAppointment","localStorage","getItem","handleDeleteAppointment","handleDeleteAllAppointment","doctor","available_resource_id","map","componentDidMount","render","loadPage","doctors","Set","x","emptyPage","page","list","length"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport Tile from '../components/Tile/Tile'\n\nimport styles from './AppointmentPage.module.css'\n\nimport Spinner from 'react-bootstrap/Spinner'\n\n\n\nconst BASE_URL = \"https://back-q-doctor.herokuapp.com/api\"\nconst APPOINTMENT_URL = \"/people/appointments\"\n\n\nexport default class AppointmentPage extends React.Component{\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {departments: [], loading: {flg: true}};\n\t}\n\n\tfetchAppointment(omsNumber, birthDate) {\n\t\treturn fetch(BASE_URL+APPOINTMENT_URL+`?oms_number=${omsNumber}&birth_date=${birthDate}`,\n\t\t\t\t\t\t\t\t {headers: {'Content-Type': 'application/json'}})\n\t\t\t\t\t\t.then(response => response.json())\n\t\t\t\t\t\t.then(response => this.setState({...this.state, departments: response}))\n            .catch(err => this.setState({...this.state, departments: []}))\n            .finally(_ => this.setState({...this.state, loading: {flg: false}}));\n  };\n\n  fetchDeleteAppointment(appointmentId, omsNumber, birthDate) {\n\t\treturn fetch(BASE_URL+APPOINTMENT_URL+`/${appointmentId}?oms_number=${omsNumber}&birth_date=${birthDate}`,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tmethod: 'DELETE',\n\t\t\t\t\t\t\t\t\t\theaders: {'Content-Type': 'application/json'},\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(()=>this.setState({...this.state, departments: this.state.departments.filter(department => department.appointment_id !== appointmentId)}));\n\t};\n\n\thandleAppointment() {\n    this.setState({...this.state, loading: {flg: true}});\n    this.fetchAppointment(localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n  }\n\n\thandleDeleteAppointment(appointmentId) {\n\t\tthis.fetchDeleteAppointment(appointmentId, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n\t};\n\n\thandleDeleteAllAppointment(doctor) {\n\t\tthis.state.departments.filter(department => department.available_resource_id === doctor).map(department =>\n\t\t\tthis.fetchDeleteAppointment(department.appointment_id, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate')));\n\t};\n\n\tcomponentDidMount() {\n\t\tthis.handleAppointment();\n\t}\n\n\trender() {\n\t\tconst loadPage = <div className={styles.loadPage} ><Spinner animation=\"border\" variant=\"primary\" /></div>;\n\t\t\n\t\tif (this.state.loading.flg) {\n\t\t\treturn loadPage;\n\t\t}\n\t\t\n\t\tconst doctors = [...new Set(this.state.departments.map(x => x.available_resource_id))];\n\t\tconst emptyPage = <h2>{'У вас пока нет записей!'}</h2>;\n\t\tconst page = (\n\t\t\t<div className={styles.page}>\n\t\t\t<ul className={styles.list}>\n\t\t\t\t{doctors\n\t\t\t\t\t.map(doctor => \n\t\t\t\t\t\t<Tile\n\t\t\t\t\t\t\tkey={doctor}\n\t\t\t\t\t\t\thandleDelete={() => this.props.handleDeleteAllAppointment(doctor)}\n\t\t\t\t\t\t\thandleDeleteItem={this.props.handleDeleteAppointment}\n\t\t\t\t\t\t\tappointments={this.props.departments.filter(x => x.available_resource_id === doctor)}\n\t\t\t\t\t\t/>)\n\t\t\t\t}\n\t\t\t</ul>\n\t\t</div>\n\t\t);\n\n\t\treturn  this.state.departments.length === 0 ? emptyPage : page;\n\t};\n};\n"]},"metadata":{},"sourceType":"module"}