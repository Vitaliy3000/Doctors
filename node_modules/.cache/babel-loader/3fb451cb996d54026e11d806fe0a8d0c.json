{"ast":null,"code":"var _jsxFileName = \"/Users/17476018U/Google \\u0414\\u0438\\u0441\\u043A/Projects/Frontend/Project/DoctorsFront/src/pages/AppointmentPage.js\";\nimport React from 'react';\nimport Tile from '../components/Tile/Tile';\nimport styles from './AppointmentPage.module.css';\nconst BASE_URL = \"http://back-q-doctor.herokuapp.com/api\";\nconst APPOINTMENT_URL = \"/people/appointments\";\nexport default class AppointmentPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      departments: [],\n      doctors: []\n    };\n    this.handleDeleteAllAppointment = this.handleDeleteAllAppointment.bind(this);\n    this.handleDeleteAppointment = this.handleDeleteAppointment.bind(this);\n  }\n\n  fetchDeleteAppointment(appointmentId, omsNumber, birthDate) {\n    return fetch(BASE_URL + APPOINTMENT_URL + \"/\".concat(appointmentId, \"?oms_number=\").concat(omsNumber, \"&birth_date=\").concat(birthDate), {\n      method: 'DELETE'\n    }).then(() => this.setState({\n      departments: this.state.departments.filter(department => department.appointment_id !== appointmentId)\n    }));\n  }\n\n  handleDeleteAppointment(appointmentId) {\n    this.fetchDeleteAppointment(appointmentId, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n  }\n\n  handleDeleteAllAppointment(doctor) {\n    this.state.departments.filter(department => department.available_resource_id === doctor).map(department => this.fetchDeleteAppointment(department.appointment_id, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate')));\n  }\n\n  fetchAppointment(omsNumber, birthDate) {\n    return fetch(BASE_URL + APPOINTMENT_URL + \"?oms_number=\".concat(omsNumber, \"&birth_date=\").concat(birthDate)).then(response => response.json()).then(response => this.setState({\n      departments: response\n    })).catch(err => this.setState({\n      departments: []\n    }));\n  }\n\n  componentWillMount() {\n    const schedule = JSON.parse(localStorage.getItem('schedule'));\n\n    if (schedule !== null && Object.entries(schedule).length !== 0) {\n      this.fetchAppointment(localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n    }\n  }\n\n  render() {\n    const schedule = JSON.parse(localStorage.getItem('schedule'));\n\n    if (schedule !== null && Object.entries(schedule).length !== 0) {\n      if (this.state.departments.length === 0) {\n        return React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 56\n          },\n          __self: this\n        }, \"\\u0418\\u0434\\u0435\\u0442 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430\");\n      }\n\n      const doctors = [...new Set(this.state.departments.map(x => x.available_resource_id))];\n      return React.createElement(\"div\", {\n        className: styles.page,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, React.createElement(\"ul\", {\n        className: styles.list,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, doctors.map(doctor => React.createElement(Tile, {\n        key: doctor,\n        handleDelete: () => this.handleDeleteAllAppointment(doctor),\n        handleDeleteItem: this.handleDeleteAppointment,\n        appointments: this.state.departments.filter(x => x.available_resource_id === doctor),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }))));\n    }\n\n    return React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \"\\u0421\\u043D\\u0430\\u0447\\u0430\\u043B\\u0430 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0443\\u0439\\u0442\\u0435\\u0441\\u044C!\");\n  }\n\n}","map":{"version":3,"sources":["/Users/17476018U/Google Диск/Projects/Frontend/Project/DoctorsFront/src/pages/AppointmentPage.js"],"names":["React","Tile","styles","BASE_URL","APPOINTMENT_URL","AppointmentPage","Component","constructor","props","state","departments","doctors","handleDeleteAllAppointment","bind","handleDeleteAppointment","fetchDeleteAppointment","appointmentId","omsNumber","birthDate","fetch","method","then","setState","filter","department","appointment_id","localStorage","getItem","doctor","available_resource_id","map","fetchAppointment","response","json","catch","err","componentWillMount","schedule","JSON","parse","Object","entries","length","render","Set","x","page","list"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport Tile from '../components/Tile/Tile'\n\nimport styles from './AppointmentPage.module.css'\n\n\nconst BASE_URL = \"http://back-q-doctor.herokuapp.com/api\"\nconst APPOINTMENT_URL = \"/people/appointments\"\n\n\nexport default class AppointmentPage extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {departments: [], doctors: []};\n\t\tthis.handleDeleteAllAppointment = this.handleDeleteAllAppointment.bind(this);\n\t\tthis.handleDeleteAppointment = this.handleDeleteAppointment.bind(this);\n\t}\n\n\tfetchDeleteAppointment(appointmentId, omsNumber, birthDate) {\n\t\treturn fetch(BASE_URL+APPOINTMENT_URL+`/${appointmentId}?oms_number=${omsNumber}&birth_date=${birthDate}`,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tmethod: 'DELETE'\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(()=>this.setState({departments: this.state.departments.filter(department => department.appointment_id !== appointmentId)}));\n\t};\n\n\thandleDeleteAppointment(appointmentId) {\n\t\tthis.fetchDeleteAppointment(appointmentId, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n\t};\n\n\thandleDeleteAllAppointment(doctor) {\n\t\tthis.state.departments.filter(department => department.available_resource_id === doctor).map(department =>\n\t\t\tthis.fetchDeleteAppointment(department.appointment_id, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate')));\n\t};\n\n\tfetchAppointment(omsNumber, birthDate) {\n\t\treturn fetch(BASE_URL+APPOINTMENT_URL+`?oms_number=${omsNumber}&birth_date=${birthDate}`)\n\t\t\t\t\t\t.then(response => response.json())\n\t\t\t\t\t\t.then(response => this.setState({departments: response}))\n\t\t\t\t\t\t.catch(err => this.setState({departments: []}));\n\t}\n\n\tcomponentWillMount() {\n\t\tconst schedule = JSON.parse(localStorage.getItem('schedule'));\n  \tif ((schedule!==null) && (Object.entries(schedule).length !== 0)) {\n\t\t\tthis.fetchAppointment(localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'));\n\t\t}\n\t}\n\n\trender() {\n\t\tconst schedule = JSON.parse(localStorage.getItem('schedule'));\n\t\tif ((schedule!==null) && (Object.entries(schedule).length !== 0)) {\n\t\t\tif (this.state.departments.length === 0) {\n\t\t\t\treturn <h2>Идет загрузка</h2>;\n\t\t\t}\n\n\t\t\tconst doctors = [...new Set(this.state.departments.map(x => x.available_resource_id))];\n\t\t\treturn (\n\t\t\t\t<div className={styles.page}>\n\t\t\t\t\t<ul className={styles.list}>\n\t\t\t\t\t\t{doctors\n\t\t\t\t\t\t .map(doctor => \n\t\t\t\t\t\t\t\t<Tile\n\t\t\t\t\t\t\t\t\tkey={doctor}\n\t\t\t\t\t\t\t\t\thandleDelete={() => this.handleDeleteAllAppointment(doctor)}\n\t\t\t\t\t\t\t\t\thandleDeleteItem={this.handleDeleteAppointment}\n\t\t\t\t\t\t\t\t\tappointments={this.state.departments.filter(x => x.available_resource_id === doctor)}\n\t\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t}\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn <h2>Сначала авторизуйтесь!</h2>;\n};\n}\n"]},"metadata":{},"sourceType":"module"}