{"ast":null,"code":"const BASE_URL = \"https://back-q-doctor.herokuapp.com/api\";\nconst APPOINTMENT_URL = \"/people/appointments\";\n\nfunction fetchCreateAppointment(appointments) {\n  return Promise.all(appointments.map(appointment => fetch(BASE_URL + APPOINTMENT_URL, {\n    method: 'POST',\n    body: JSON.stringify(appointment),\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })));\n}\n\nfunction fetchLoadAppointment(omsNumber, birthDate) {\n  return fetch(BASE_URL + APPOINTMENT_URL + \"?oms_number=\".concat(omsNumber, \"&birth_date=\").concat(birthDate), {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  });\n}\n\n;\n\nfunction fetchDeleteAppointment(appointmentId, omsNumber, birthDate) {\n  return fetch(BASE_URL + APPOINTMENT_URL + \"/\".concat(appointmentId, \"?oms_number=\").concat(omsNumber, \"&birth_date=\").concat(birthDate), {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  });\n}\n\n; // handleDeleteAppointment(appointmentId) {\n// \tthis.fetchDeleteAppointment(appointmentId, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'))\n// \t.then(()=>this.setState({departments: this.state.departments.filter(department => department.appointment_id !== appointmentId)}));\n// };\n// handleDeleteAllAppointment(doctor) {\n// \tthis.state.departments.filter(department => department.available_resource_id === doctor).map(department =>\n// \t\tthis.fetchDeleteAppointment(department.appointment_id, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'))\n// \t\t.then(()=>this.setState({departments: this.state.departments.filter(department => department.available_resource_id !== doctor)})));\n// };\n\nfunction generateBodyForCreateAppointment() {\n  const appointments = [];\n\n  for (let key of Object.keys(this.state).filter(key => this.state[key])) {\n    const start = new Date(Date.parse(key));\n    const end = new Date(new Date(start).setDate(start.getDate() + 1));\n    appointments.push({\n      \"appointment\": {\n        \"available_resource_id\": String(this.props.availableResourceId),\n        \"complex_resource_id\": String(this.props.complexResourceId),\n        \"start_time\": start.toISOString().split('.')[0],\n        \"finish_time\": end.toISOString().split('.')[0],\n        \"lpu_id\": String(this.props.lpuId),\n        \"priority\": 0,\n        \"reception_type_code_or_ldp_type_code\": this.props.code\n      },\n      \"person\": {\n        \"birth_date\": localStorage.getItem('birthDate'),\n        \"oms_number\": localStorage.getItem('omsNumber')\n      }\n    });\n  }\n}\n\n;\nexport const createAppointment = payload => {\n  return function (dispatch) {\n    dispatch(createAppointmentAction);\n    return fetchCreateAppointment(payload).then(response => dispatch(createAppointmentSuccess));\n  };\n};\nexport const loadAppointment = payload => {\n  return function (dispatch) {\n    dispatch(loadAppointmentAction);\n    return fetchLoadAppointment(...payload).then(response => response.json()).then(response => dispatch(loadAppointmentSuccess(response)));\n  };\n};\nexport const deleteAppointment = payload => {\n  return function (dispatch) {\n    dispatch(deleteAppointmentAction);\n    return fetchDeleteAppointment(...payload).then(response => response.json()).then(response => dispatch(deleteAppointmentSuccess(response)));\n  };\n};\nexport const createAppointmentAction = {\n  type: 'CREATE_APPOINTMENT',\n  payload: null\n};\nexport const createAppointmentSuccess = payload => ({\n  type: 'CREATE_APPOINTMENT_SUCCESS',\n  payload: null\n});\nexport const loadAppointmentAction = {\n  type: 'LOAD_APPOINTMENT',\n  payload: null\n};\nexport const loadAppointmentSuccess = payload => ({\n  type: 'LOAD_APPOINTMENT_SUCCESS',\n  payload: payload\n});\nexport const deleteAppointmentAction = {\n  type: 'DELETE_APPOINTMENT',\n  payload: null\n};\nexport const deleteAppointmentSuccess = payload => ({\n  type: 'DELETE_APPOINTMENT_SUCCESS',\n  payload: payload\n});","map":{"version":3,"sources":["/Users/17476018U/Google Диск/Projects/Frontend/Project/DoctorsFront/src/redux/appointment/actions.js"],"names":["BASE_URL","APPOINTMENT_URL","fetchCreateAppointment","appointments","Promise","all","map","appointment","fetch","method","body","JSON","stringify","headers","fetchLoadAppointment","omsNumber","birthDate","fetchDeleteAppointment","appointmentId","generateBodyForCreateAppointment","key","Object","keys","state","filter","start","Date","parse","end","setDate","getDate","push","String","props","availableResourceId","complexResourceId","toISOString","split","lpuId","code","localStorage","getItem","createAppointment","payload","dispatch","createAppointmentAction","then","response","createAppointmentSuccess","loadAppointment","loadAppointmentAction","json","loadAppointmentSuccess","deleteAppointment","deleteAppointmentAction","deleteAppointmentSuccess","type"],"mappings":"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","sourcesContent":["const BASE_URL = \"https://back-q-doctor.herokuapp.com/api\"\nconst APPOINTMENT_URL = \"/people/appointments\"\n\n\nfunction fetchCreateAppointment(appointments) {\n\treturn Promise.all(appointments.map(appointment =>\n\t\tfetch(\n\t\t\tBASE_URL+APPOINTMENT_URL,\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: JSON.stringify(appointment),\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t));\n}\n\nfunction fetchLoadAppointment(omsNumber, birthDate) {\n  return fetch(\n    BASE_URL+APPOINTMENT_URL+`?oms_number=${omsNumber}&birth_date=${birthDate}`,\n    {\n      method: 'GET',\n      headers: {'Content-Type': 'application/json'},\n    },\n  );\n};\n\n\nfunction fetchDeleteAppointment(appointmentId, omsNumber, birthDate) {\n\treturn fetch(\n\t\tBASE_URL+APPOINTMENT_URL+`/${appointmentId}?oms_number=${omsNumber}&birth_date=${birthDate}`,\n\t\t{\n\t\t\tmethod: 'DELETE',\n\t\t\theaders: {'Content-Type': 'application/json'},\n\t\t});\n};\n\n\n\n\n\n// handleDeleteAppointment(appointmentId) {\n// \tthis.fetchDeleteAppointment(appointmentId, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'))\n// \t.then(()=>this.setState({departments: this.state.departments.filter(department => department.appointment_id !== appointmentId)}));\n// };\n\n// handleDeleteAllAppointment(doctor) {\n// \tthis.state.departments.filter(department => department.available_resource_id === doctor).map(department =>\n// \t\tthis.fetchDeleteAppointment(department.appointment_id, localStorage.getItem('omsNumber'), localStorage.getItem('birthDate'))\n// \t\t.then(()=>this.setState({departments: this.state.departments.filter(department => department.available_resource_id !== doctor)})));\n// };\n\nfunction generateBodyForCreateAppointment() {\n\tconst appointments = [];\n\tfor (let key of Object.keys(this.state).filter(key => this.state[key])) {\n\t\tconst start = new Date(Date.parse(key));\n\t\tconst end = new Date(new Date(start).setDate(start.getDate()+1))\n\t\tappointments.push({\n\t\t\t\"appointment\": {\n\t\t\t\t\"available_resource_id\": String(this.props.availableResourceId),\n\t\t\t\t\"complex_resource_id\": String(this.props.complexResourceId),\n\t\t\t\t\"start_time\": start.toISOString().split('.')[0],\n\t\t\t\t\"finish_time\": end.toISOString().split('.')[0],\n\t\t\t\t\"lpu_id\": String(this.props.lpuId),\n\t\t\t\t\"priority\": 0,\n\t\t\t\t\"reception_type_code_or_ldp_type_code\": this.props.code,\n\t\t\t},\n\t\t\t\"person\": {\n\t\t\t\t\"birth_date\": localStorage.getItem('birthDate'),\n\t\t\t\t\"oms_number\": localStorage.getItem('omsNumber'),\n\t\t\t}\n\t\t})\n\t}\n};\n\nexport const createAppointment = payload => {\n\treturn function(dispatch) {\n\t\tdispatch(createAppointmentAction)\n\t\treturn fetchCreateAppointment(payload)\n\t\t\t.then(response => dispatch(createAppointmentSuccess));\n\t};\n};\n\nexport const loadAppointment = payload => {\n\treturn function(dispatch) {\n    dispatch(loadAppointmentAction);\n\t\treturn fetchLoadAppointment(...payload)\n\t\t\t.then(response => response.json())\n\t\t\t.then(response => dispatch(loadAppointmentSuccess(response)));\n\t};\n};\n\nexport const deleteAppointment = payload => {\n\treturn function(dispatch) {\n    dispatch(deleteAppointmentAction);\n\t\treturn fetchDeleteAppointment(...payload)\n\t\t\t.then(response => response.json())\n\t\t\t.then(response => dispatch(deleteAppointmentSuccess(response)));\n\t};\n};\n\nexport const createAppointmentAction = {\n\ttype: 'CREATE_APPOINTMENT',\n\tpayload: null,\n};\n\nexport const createAppointmentSuccess = payload => ({\n\ttype: 'CREATE_APPOINTMENT_SUCCESS',\n\tpayload: null,\n});\n\nexport const loadAppointmentAction = {\n\ttype: 'LOAD_APPOINTMENT',\n\tpayload: null,\n};\n\nexport const loadAppointmentSuccess = payload => ({\n\ttype: 'LOAD_APPOINTMENT_SUCCESS',\n\tpayload: payload,\n});\n\nexport const deleteAppointmentAction = {\n\ttype: 'DELETE_APPOINTMENT',\n\tpayload: null,\n};\n\nexport const deleteAppointmentSuccess = payload => ({\n\ttype: 'DELETE_APPOINTMENT_SUCCESS',\n\tpayload: payload,\n});\n"]},"metadata":{},"sourceType":"module"}